<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test jiekou.ai API</title>
    <style>
        body { font-family: Arial; padding: 20px; background: #050508; color: white; }
        button { padding: 10px 20px; font-size: 16px; cursor: pointer; background: linear-gradient(135deg, #ff00ff, #00ffff); border: none; border-radius: 8px; color: #050508; }
        #status { margin: 20px 0; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; }
        #result { margin-top: 20px; }
        img { max-width: 500px; border-radius: 8px; margin-top: 20px; }
        pre { background: rgba(0,0,0,0.5); padding: 10px; border-radius: 8px; overflow: auto; max-height: 200px; }
    </style>
</head>
<body>
    <h1>Test jiekou.ai API</h1>
    <button onclick="testAPI()">Generate Image</button>
    <div id="status">Click to test...</div>
    <div id="result"></div>

    <script>
        const JIEKOU_API_KEY = 'sk_-GORE__SpgDqJ4U__jLnVTRTtupCL1QmoZk4UPB2RLg'
        
        async function testAPI() {
            const status = document.getElementById('status')
            const result = document.getElementById('result')
            
            status.textContent = 'Generating... (this may take 30-60s)'
            result.innerHTML = ''
            
            const startTime = Date.now()
            
            try {
                console.log('Starting API call...')
                
                const response = await fetch('https://api.jiekou.ai/v1/images/generations', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ' + JIEKOU_API_KEY
                    },
                    body: JSON.stringify({
                        model: 'gpt-image-1',
                        prompt: 'A cyberpunk city with neon lights at night, poster style, high quality',
                        n: 1,
                        size: 'auto'
                    })
                })
                
                const elapsed = (Date.now() - startTime) / 1000
                console.log('Response received in', elapsed, 'seconds, status:', response.status)
                
                const data = await response.json()
                console.log('Data:', data)
                
                status.textContent = 'API call completed in ' + elapsed.toFixed(1) + 's'
                
                if (data.data && data.data[0]) {
                    const imageData = data.data[0]
                    if (imageData.b64_json) {
                        const img = document.createElement('img')
                        img.src = 'data:image/png;base64,' + imageData.b64_json
                        result.innerHTML = '<pre>' + JSON.stringify(data.usage, null, 2) + '</pre>'
                        result.appendChild(img)
                    } else if (imageData.url) {
                        result.innerHTML = '<p>URL: ' + imageData.url + '</p>'
                    }
                } else {
                    result.innerHTML = '<pre>' + JSON.stringify(data, null, 2) + '</pre>'
                }
            } catch (err) {
                console.error('Error:', err)
                status.textContent = 'Error: ' + err.message
                result.innerHTML = '<pre>Error: ' + err.message + '\n\nStack: ' + err.stack + '</pre>'
            }
        }
    </script>
</body>
</html>
